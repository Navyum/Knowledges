"use strict";(self.webpackChunknavyum_blog=self.webpackChunknavyum_blog||[]).push([[51116],{36995:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,e]of i)a[s]=e;return a}},89112:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>t,data:()=>h});var e=a(6254);const n={},t=(0,a(36995).A)(n,[["render",function(s,i){return(0,e.uX)(),(0,e.CE)("div",null,i[0]||(i[0]=[(0,e.Fv)('<h2 id="systemtap安装" tabindex="-1"><a class="header-anchor" href="#systemtap安装"><span>systemTap安装</span></a></h2><h2 id="当前环境-cenos7" tabindex="-1"><a class="header-anchor" href="#当前环境-cenos7"><span>当前环境：cenos7</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /etc/redhat-release</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> CentOS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> release</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7.9.2009</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Core) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看操作系统版本</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$uname</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -r</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 3.10.0-1160.53.1.el7.x86_64</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 查看内核版本</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装：</span></a></h2><h3 id="安装systemtap" tabindex="-1"><a class="header-anchor" href="#安装systemtap"><span>安装systemtap</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemtap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemtap-runtime</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="安装依赖" tabindex="-1"><a class="header-anchor" href="#安装依赖"><span>安装依赖</span></a></h3><p>依赖项： * <code>kernel-devel-$(uname -r)、kernel-debuginfo-$(uname -r)、kernel-debuginfo-common-$(uname -r)</code> * 依赖项一定要和内核版本一致，否则无法成功。如果不一致，则需要安装kernel、kernel-devel。</p><h4 id="一、自动安装" tabindex="-1"><a class="header-anchor" href="#一、自动安装"><span>一、自动安装</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stap-prep</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 一般安装都会报错，需要手动安装</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="二、手动安装" tabindex="-1"><a class="header-anchor" href="#二、手动安装"><span>二、手动安装</span></a></h4><ol><li><p>yum 直接安装</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kernel-devel-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kernel-debuginfo-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kernel-debuginfo-common-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果报错：`No package kernel-xx available，则需要使用下面的手动下载对应rpm，然后安装</p></li><li><p>yum 离线安装</p><ul><li><strong>离线安装kernel、kernel-devel</strong><ul><li>如何找离线包： <ul><li>镜像地址1：<code>https://mirrors.aliyun.com/centos-vault/$your_centos_version/updates/x86_64/Packages/kernel-$(uname -r).rpm</code></li><li>镜像地址2：<code>https://mirror.tuna.tsinghua.edu.cn/centos-vault/$your_centos_version/updates/x86_64/Packages/kernel-$(uname -r).rpm</code></li><li>注意⚠️：vault表示过期的镜像，因为7系列已经不在维护了，所以对应系统的包只能到这个里面找</li></ul></li><li>找到后右键复制下载地址</li><li>下载离线包 <code>$ sudo wget 下载地址</code></li><li>安装离线包 <code>$ sudo rpm -ivh kernel-xxx.rpm</code></li></ul></li><li><strong>kernel-debuginfo 的另一种安装方式</strong>：<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> debuginfo-install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kernel-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ol><h4 id="验证systemtap" tabindex="-1"><a class="header-anchor" href="#验证systemtap"><span>验证systemtap</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stap</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;probe vfs.read {printf(&quot;read performed\\n&quot;); exit()}&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> parsed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> script</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 476</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> library</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scripts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 272304virt/69548res/3500shr/66148data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kb,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 670usr/40sys/714real</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ms.</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> analyzed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> script:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> probe,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> function,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> embeds,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> globals</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 439692virt/232156res/4832shr/233536data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kb,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1970usr/460sys/2424real</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ms.</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cached</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /root/.systemtap/cache/3a/stap_3acbc48da4d846dbd13b2e55b382b10f_2806.c</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cached</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /root/.systemtap/cache/3a/stap_3acbc48da4d846dbd13b2e55b382b10f_2806.ko</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run.</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> performed</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> completed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0usr/30sys/342real</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ms.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看到 run completed 则表示安装成功</p>',15)]))}]]),h=JSON.parse('{"path":"/%E5%B7%A5%E5%85%B7%E6%AD%A6%E5%99%A8%E5%BA%93/%E5%8A%A8%E6%80%81%E8%BF%BD%E8%B8%AA%E6%8A%80%E6%9C%AFTracing/systemTap%E5%AE%89%E8%A3%85.html","title":"systemTap安装","lang":"zh-CN","frontmatter":{"title":"systemTap安装","date":"2025-04-03T10:32:17.000Z","author":"Navyum","tags":["SystemTap","性能分析"],"categories":["工具","性能分析","Systemtap"],"description":"systemTap安装 当前环境：cenos7 安装： 安装systemtap 安装依赖 依赖项： * kernel-devel-$(uname -r)、kernel-debuginfo-$(uname -r)、kernel-debuginfo-common-$(uname -r) * 依赖项一定要和内核版本一致，否则无法成功。如果不一致，则需要安装k...","head":[["meta",{"property":"og:url","content":"https://myblog.camscanner.top/%E5%B7%A5%E5%85%B7%E6%AD%A6%E5%99%A8%E5%BA%93/%E5%8A%A8%E6%80%81%E8%BF%BD%E8%B8%AA%E6%8A%80%E6%9C%AFTracing/systemTap%E5%AE%89%E8%A3%85.html"}],["meta",{"property":"og:site_name","content":"Navyum\'s Blog"}],["meta",{"property":"og:title","content":"systemTap安装"}],["meta",{"property":"og:description","content":"systemTap安装 当前环境：cenos7 安装： 安装systemtap 安装依赖 依赖项： * kernel-devel-$(uname -r)、kernel-debuginfo-$(uname -r)、kernel-debuginfo-common-$(uname -r) * 依赖项一定要和内核版本一致，否则无法成功。如果不一致，则需要安装k..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-17T03:50:17.000Z"}],["meta",{"property":"article:author","content":"Navyum"}],["meta",{"property":"article:tag","content":"SystemTap"}],["meta",{"property":"article:tag","content":"性能分析"}],["meta",{"property":"article:published_time","content":"2025-04-03T10:32:17.000Z"}],["meta",{"property":"article:modified_time","content":"2025-06-17T03:50:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"systemTap安装\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-04-03T10:32:17.000Z\\",\\"dateModified\\":\\"2025-06-17T03:50:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Navyum\\"}]}"]]},"git":{"createdTime":1749983452000,"updatedTime":1750132217000,"contributors":[{"name":"Navyum","username":"Navyum","email":"36869790+Navyum@users.noreply.github.com","commits":1,"url":"https://github.com/Navyum"},{"name":"haijun_yang","username":"haijun_yang","email":"haijun_yang@intsig.net","commits":1,"url":"https://github.com/haijun_yang"}]},"readingTime":{"minutes":1.39,"words":418},"filePathRelative":"工具武器库/动态追踪技术Tracing/systemTap安装.md","localizedDate":"2025年4月3日","excerpt":"<h2>systemTap安装</h2>\\n<h2>当前环境：cenos7</h2>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">$cat</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> /etc/redhat-release</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\"> CentOS</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> Linux</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> release</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 7.9.2009</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> (Core) </span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 查看操作系统版本</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">$uname</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> -r</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\"> 3.10.0-1160.53.1.el7.x86_64</span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">      # 查看内核版本</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);
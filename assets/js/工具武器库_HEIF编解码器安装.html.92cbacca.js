"use strict";(self.webpackChunknavyum_blog=self.webpackChunknavyum_blog||[]).push([[53168],{36995:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,n]of i)a[s]=n;return a}},68832:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>l,data:()=>t});var n=a(6254);const e={},l=(0,a(36995).A)(e,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,i[0]||(i[0]=[(0,n.Fv)('<h2 id="heif编解码器安装与配置指南" tabindex="-1"><a class="header-anchor" href="#heif编解码器安装与配置指南"><span>HEIF编解码器安装与配置指南</span></a></h2><p>HEIF（High Efficiency Image Format）是一种高效的图像格式，基于HEVC（H.265）编码标准，相比JPEG格式能够提供更好的压缩率和图像质量。本文详细介绍如何在CentOS 7环境下安装和配置HEIF编解码器，支持多种编码格式的转换。</p><h3 id="技术背景" tabindex="-1"><a class="header-anchor" href="#技术背景"><span>技术背景</span></a></h3><h4 id="heif编码解码原理" tabindex="-1"><a class="header-anchor" href="#heif编码解码原理"><span>HEIF编码解码原理</span></a></h4><figure><img src="https://raw.staticdn.net/Navyum/imgbed/main/IMG/21139a95b55bedab5c5a1eaf9a9c4f0b.png" alt="Img" tabindex="0" loading="lazy"><figcaption>Img</figcaption></figure><h4 id="支持的编码标准" tabindex="-1"><a class="header-anchor" href="#支持的编码标准"><span>支持的编码标准</span></a></h4><ul><li><strong>H.264/MPEG-4 AVC</strong>：传统视频编码标准</li><li><strong>H.265/HEVC</strong>：高效视频编码，HEIF的主要编码标准</li><li><strong>AVIF</strong>：基于AV1编码的图像格式（AV1/AOM、dav1d）</li><li><strong>H.266/VVC</strong>：下一代视频编码标准</li></ul><h4 id="核心依赖库" tabindex="-1"><a class="header-anchor" href="#核心依赖库"><span>核心依赖库</span></a></h4><p><strong>主要编解码库：</strong></p><ul><li><code>libx265</code>：HEVC编码器</li><li><code>libde265</code>：HEVC解码器</li><li><code>libaom</code>：AV1编码器</li><li><code>libvvenc</code>：VVC编码器</li><li><code>libheif</code>：HEIF格式处理核心库</li><li><code>libvips</code>：图像处理库</li></ul><p><strong>其他参考库：</strong></p><ul><li><code>libavif</code>：AVIF格式处理库</li></ul><h4 id="编译工具要求" tabindex="-1"><a class="header-anchor" href="#编译工具要求"><span>编译工具要求</span></a></h4><p>安装过程中需要以下编译工具：</p><ul><li><code>gcc-6+</code>、<code>g++</code>：C/C++编译器</li><li><code>make</code>：构建工具</li><li><code>cmake-3.x</code>：跨平台构建系统</li><li><code>meson</code>：现代构建系统</li><li><code>ninja</code>：快速构建工具</li></ul><h3 id="安装前准备" tabindex="-1"><a class="header-anchor" href="#安装前准备"><span>安装前准备</span></a></h3><p><strong>重要提醒：</strong> 安装依赖时必须严格按照顺序进行，前面的库是后续库的必要依赖。如果依赖安装不正确，虽然后续库可能编译通过，但无法正常使用HEIF功能。</p><h3 id="centos-7-环境安装步骤" tabindex="-1"><a class="header-anchor" href="#centos-7-环境安装步骤"><span>CentOS 7 环境安装步骤</span></a></h3><h4 id="_1-安装基础图片格式库【必须】" tabindex="-1"><a class="header-anchor" href="#_1-安装基础图片格式库【必须】"><span>1. 安装基础图片格式库【必须】</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  libpng-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  glib2-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  libjpeg-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  expat-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  zlib-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  giflib-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  libtiff-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  libexif-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  libtool</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-安装编译工具【必须】" tabindex="-1"><a class="header-anchor" href="#_2-安装编译工具【必须】"><span>2. 安装编译工具【必须】</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  automake</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  gcc</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  make</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  gcc-c++</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-源码安装webp库【可选】" tabindex="-1"><a class="header-anchor" href="#_3-源码安装webp库【可选】"><span>3. 源码安装WebP库【可选】</span></a></h4><p>WebP是Google开发的现代图像格式，提供更好的压缩率。</p><p><strong>官方地址：</strong> <a href="https://chromium.googlesource.com/webm/libwebp" target="_blank" rel="noopener noreferrer">Google WebP</a></p><p><strong>安装步骤（以v1.4.0为例）：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://chromium.googlesource.com/webm/libwebp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libwebp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remotes/origin/1.4.0</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./autogen.sh</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./configure</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enable-libwebpmux</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enable-libwebpdemux</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enable-libwebpdecoder</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-源码安装libde265解码器【必须】" tabindex="-1"><a class="header-anchor" href="#_4-源码安装libde265解码器【必须】"><span>4. 源码安装libde265解码器【必须】</span></a></h4><p>libde265是开源的HEVC解码器，用于解码HEIF格式图像。</p><p><strong>官方地址：</strong> <a href="https://github.com/strukturag/libde265/releases" target="_blank" rel="noopener noreferrer">libde265 Releases</a></p><p><strong>安装步骤（以v1.0.15为例）：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/strukturag/libde265/releases/download/v1.0.15/libde265-1.0.15.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libde265-1.0.15.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libde265-1.0.15</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./configure</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-源码安装libx265编码器【必须】" tabindex="-1"><a class="header-anchor" href="#_5-源码安装libx265编码器【必须】"><span>5. 源码安装libx265编码器【必须】</span></a></h4><p>libx265是开源的HEVC编码器，用于将图像编码为HEIF格式。</p><p><strong>官方地址：</strong> <a href="https://github.com/videolan/x265" target="_blank" rel="noopener noreferrer">libx265 GitHub</a></p><p><strong>安装步骤（以v3.4为例）：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/videolan/x265/archive/refs/tags/3.4.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3.4.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x265-3.4</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x265/build/linux</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./make-Makefiles.bash</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 键入 g，生成对应环境的Makefile</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ../..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-源码安装libheif【必须】" tabindex="-1"><a class="header-anchor" href="#_6-源码安装libheif【必须】"><span>6. 源码安装libheif【必须】</span></a></h4><p>libheif是HEIF格式处理的核心库，提供编码、解码和格式转换功能。</p><p><strong>官方地址：</strong></p><ul><li><a href="https://github.com/strukturag/libheif" target="_blank" rel="noopener noreferrer">libheif GitHub</a></li><li><a href="https://github.com/nokiatech/heif" target="_blank" rel="noopener noreferrer">Nokia HEIF解析</a></li></ul><p><strong>前置依赖：</strong> 需要cmake 3.3+版本</p><p><strong>6.1 安装CMake 3.26.4（CentOS 7需要源码安装）</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl-devel</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://cmake.org/files/v3.26/cmake-3.26.4.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmake-3.26.4.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmake-3.26.4</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./configure</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>6.2 编译安装libheif（以v1.18.2为例）</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/strukturag/libheif/releases/download/v1.18.2/libheif-1.18.2.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libheif-1.18.2.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libheif-1.18.2</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cmake</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --preset=release</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ../..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>6.3 验证安装结果</strong> 检查编解码器是否正确安装：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-enc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list-encoders</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>预期输出：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>HEIC encoders:</span></span>\n<span class="line"><span>- x265 = x265 HEVC encoder (0.0) [default]</span></span>\n<span class="line"><span>AVIF encoders:</span></span>\n<span class="line"><span>VVC encoders:</span></span>\n<span class="line"><span>JPEG encoders:</span></span>\n<span class="line"><span>- jpeg = libjpeg-turbo 1.2.90 (libjpeg 6.2) [default]</span></span>\n<span class="line"><span>JPEG 2000 encoders:</span></span>\n<span class="line"><span>HT-J2K encoders:</span></span>\n<span class="line"><span>Uncompressed encoders:</span></span>\n<span class="line"><span>- uncompressed = uncompressed [default]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>6.4 基础使用示例</strong> 此时已经可以使用heif工具进行格式转换：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看HEIF文件信息</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./heif-info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ../../tests/data/x.heif</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将JPEG转换为HEIF</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./heif-enc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.heif</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将HEIF转换为JPEG</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./heif-dec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ../../tests/data/x.heif</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c.jpg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="高级编解码器配置" tabindex="-1"><a class="header-anchor" href="#高级编解码器配置"><span>高级编解码器配置</span></a></h3><h4 id="支持的编解码器列表" tabindex="-1"><a class="header-anchor" href="#支持的编解码器列表"><span>支持的编解码器列表</span></a></h4><p>libheif支持多种格式的编解码器：</p><table><thead><tr><th style="text-align:left;">格式</th><th style="text-align:center;">解码器</th><th style="text-align:center;">编码器</th></tr></thead><tbody><tr><td style="text-align:left;">HEIC</td><td style="text-align:center;">libde265, ffmpeg</td><td style="text-align:center;">x265, kvazaar</td></tr><tr><td style="text-align:left;">AVIF</td><td style="text-align:center;">AOM, dav1d</td><td style="text-align:center;">AOM, rav1e, svt-av1</td></tr><tr><td style="text-align:left;">VVC</td><td style="text-align:center;">vvdec</td><td style="text-align:center;">vvenc, uvg266</td></tr><tr><td style="text-align:left;">AVC</td><td style="text-align:center;">openh264</td><td style="text-align:center;">-</td></tr><tr><td style="text-align:left;">JPEG</td><td style="text-align:center;">libjpeg(-turbo)</td><td style="text-align:center;">libjpeg(-turbo)</td></tr><tr><td style="text-align:left;">JPEG2000</td><td style="text-align:center;">OpenJPEG</td><td style="text-align:center;">OpenJPEG</td></tr><tr><td style="text-align:left;">uncompressed</td><td style="text-align:center;">built-in</td><td style="text-align:center;">built-in</td></tr></tbody></table><h4 id="_7-安装avif编解码器-可选" tabindex="-1"><a class="header-anchor" href="#_7-安装avif编解码器-可选"><span>7. 安装AVIF编解码器（可选）</span></a></h4><p>AVIF是基于AV1编码的图像格式，提供更好的压缩效率。</p><p><strong>7.1 安装libaom（AV1编码器）</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v3.9.1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --depth</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://aomedia.googlesource.com/aom</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aom</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cmake</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -S</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build.libavif</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Ninja</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DCMAKE_INSTALL_PREFIX=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/usr/local&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DBUILD_SHARED_LIBS=1 </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DCMAKE_BUILD_TYPE=Release </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DAOM_TARGET_CPU=generic </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DENABLE_DOCS=0 </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DENABLE_EXAMPLES=0 </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DENABLE_TESTDATA=0 </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DENABLE_TESTS=0 </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-DENABLE_TOOLS=0 </span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ninja</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build.libavif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ninja</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build.libavif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>7.2 AVIF编解码测试</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 编码为AVIF格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-enc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --avif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.avif</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 解码AVIF格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-dec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --avif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.avif</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-安装vvc编解码器-h-266-vvc-实验性功能" tabindex="-1"><a class="header-anchor" href="#_8-安装vvc编解码器-h-266-vvc-实验性功能"><span>8. 安装VVC编解码器（H.266/VVC，实验性功能）</span></a></h4><p>VVC是下一代视频编码标准，目前处于实验阶段。</p><p><strong>8.1 依赖要求</strong></p><ul><li>gcc-5.0+、cmake-3.13+版本</li><li>需要安装高版本gcc</li></ul><p><strong>8.2 安装高版本GCC</strong><strong>方式一：源码编译（耗时60分钟以上）</strong></p><p><strong>方式二：使用红帽SCL版本（推荐）</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. 安装SCL仓库</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> centos-release-scl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> centos-release-scl-rh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. 修改SCL源为阿里云（CentOS7的SCL源在2024年6月30日停止维护）</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/yum.repos.d/CentOS-SCLo-rh.repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[centos-sclo-rh]</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">name=CentOS-7 - SCLo rh</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">baseurl=https://mirrors.aliyun.com/centos/7/sclo/x86_64/rh/</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gpgcheck=1</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">enabled=1</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-SCLo</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. 安装gcc-9开发包</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> devtoolset-9-gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> devtoolset-9-gcc-c++</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> devtoolset-9-binutils</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. 启用并验证版本</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> devtoolset-9</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bash</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>8.3 安装VVC编码器</strong><strong>官方地址：</strong> <a href="https://github.com/fraunhoferhhi/vvenc" target="_blank" rel="noopener noreferrer">vvenc GitHub</a></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/fraunhoferhhi/vvenc/archive/refs/tags/v1.12.0.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v1.12.0.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vvenc-1.12.0</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install-prefix=/usr/local</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>8.4 安装VVC解码器</strong><strong>官方地址：</strong> <a href="https://github.com/fraunhoferhhi/vvdec" target="_blank" rel="noopener noreferrer">vvdec GitHub</a></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/fraunhoferhhi/vvdec/archive/refs/tags/v2.3.0.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v2.3.0.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vvdec-2.3.0</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install-prefix=/usr/local</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>8.5 重新编译libheif支持VVC</strong> 必须使用libheif-1.18.1+版本，并通过参数手动启用VVC支持：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libheif-1.18.2/build</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cmake</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_VVDEC=ON</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_VVENC=ON</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>预期输出：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vvenc VVC enc. (experimental)   : + built-in</span></span>\n<span class="line"><span>vvdec VVC dec. (experimental)   : + built-in</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>=== Supported formats ===</span></span>\n<span class="line"><span>format        decoding   encoding</span></span>\n<span class="line"><span>HEIC            YES        YES</span></span>\n<span class="line"><span>AVIF            YES        NO</span></span>\n<span class="line"><span>VVC             YES        YES</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>8.6 VVC编解码测试</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 编码为VVC格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-enc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --vvc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.heif</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 解码VVC格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-dec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.heif</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>8.7 验证编解码器安装</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看所有解码器</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-dec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list-decoders</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看所有编码器</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">heif-enc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list-encoders</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_9-安装libvips图像处理库【可选】" tabindex="-1"><a class="header-anchor" href="#_9-安装libvips图像处理库【可选】"><span>9. 安装libvips图像处理库【可选】</span></a></h4><p>libvips是一个高性能的图像处理库，支持多种格式转换。</p><p><strong>官方地址：</strong> <a href="https://github.com/libvips/libvips" target="_blank" rel="noopener noreferrer">libvips GitHub</a></p><p><strong>9.1 安装libvips v8.15.3（推荐，使用meson构建）</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 安装Python3和meson</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> python3</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pip3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> meson</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 下载并编译libvips</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libvips-x.y.x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">meson</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> setup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --prefix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">meson</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> compile</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">meson</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">meson</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>9.2 安装libvips v8.12.2（兼容版本）</strong><strong>注意：</strong> 此版本只能使用libheif v1.16及之前版本，如果libheif是最新版会出错。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/libvips/libvips/releases/download/v8.12.2/vips-8.12.2.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vips-8.12.2.tar.gz</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vips-8.12.2</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./configure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>9.3 验证libvips安装</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/bin/vips</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --vips-config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>9.4 使用vips进行格式转换</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 编码为HEIF格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vips</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.heif</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 解码为JPEG格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vips</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.heif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 编码为WebP格式</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vips</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> copy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.jpg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.webp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="应用开发集成" tabindex="-1"><a class="header-anchor" href="#应用开发集成"><span>应用开发集成</span></a></h3><h4 id="在golang项目中使用heif" tabindex="-1"><a class="header-anchor" href="#在golang项目中使用heif"><span>在Golang项目中使用HEIF</span></a></h4><p>通过<a href="https://github.com/h2non/bimg" target="_blank" rel="noopener noreferrer">bimg</a>库使用libvips进行HEIF处理：</p><div class="language-golang line-numbers-mode" data-highlighter="shiki" data-ext="golang" data-title="golang" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>package main</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>import (</span></span>\n<span class="line"><span>    &quot;fmt&quot;</span></span>\n<span class="line"><span>    &quot;log&quot;</span></span>\n<span class="line"><span>    &quot;os&quot;</span></span>\n<span class="line"><span>    &quot;github.com/h2non/bimg&quot;</span></span>\n<span class="line"><span>)</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>func main() {</span></span>\n<span class="line"><span>    // 读取图像文件</span></span>\n<span class="line"><span>    buffer, err := bimg.Read(&quot;image.jpg&quot;)</span></span>\n<span class="line"><span>    if err != nil {</span></span>\n<span class="line"><span>        fmt.Fprintln(os.Stderr, err)</span></span>\n<span class="line"><span>        return</span></span>\n<span class="line"><span>    }</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>    // 转换为HEIF格式</span></span>\n<span class="line"><span>    newImage, err := bimg.NewImage(buffer).Convert(bimg.HEIF)</span></span>\n<span class="line"><span>    if err != nil {</span></span>\n<span class="line"><span>        fmt.Fprintln(os.Stderr, err)</span></span>\n<span class="line"><span>        return</span></span>\n<span class="line"><span>    }</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>    // 保存转换后的图像</span></span>\n<span class="line"><span>    outputFile, err := os.Create(&quot;test.heif&quot;)</span></span>\n<span class="line"><span>    if err != nil {</span></span>\n<span class="line"><span>        log.Fatalf(&quot;Error creating output file: %v&quot;, err)</span></span>\n<span class="line"><span>    }</span></span>\n<span class="line"><span>    defer outputFile.Close()</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>    if _, err := outputFile.Write(newImage); err != nil {</span></span>\n<span class="line"><span>        log.Fatalf(&quot;Error saving image: %v&quot;, err)</span></span>\n<span class="line"><span>    }</span></span>\n<span class="line"><span>    </span></span>\n<span class="line"><span>    fmt.Println(&quot;Image converted to HEIF successfully!&quot;)</span></span>\n<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="docker容器化部署" tabindex="-1"><a class="header-anchor" href="#docker容器化部署"><span>Docker容器化部署</span></a></h4><p><strong>环境：</strong> CentOS 7</p><p><strong>GitHub地址：</strong> <a href="https://github.com/Navyum/heif-tools" target="_blank" rel="noopener noreferrer">heif-tools</a></p><p><strong>可用镜像：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HEIF工具镜像</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ghcr.io/navyum/heif-tools:heif-tool</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># VIPS工具镜像</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ghcr.io/navyum/heif-tools:vips-tool</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="故障排除与常见问题" tabindex="-1"><a class="header-anchor" href="#故障排除与常见问题"><span>故障排除与常见问题</span></a></h3><h4 id="常见安装问题" tabindex="-1"><a class="header-anchor" href="#常见安装问题"><span>常见安装问题</span></a></h4><ol><li><p><strong>libvips安装问题</strong></p><ul><li>参考：<a href="https://github.com/libvips/libvips/discussions/3173" target="_blank" rel="noopener noreferrer">libvips安装问题讨论</a></li></ul></li><li><p><strong>版本兼容性问题</strong></p><ul><li>libvips和libheif版本兼容问题：<code>heif_writer callback returned a null error text (5.2001)</code></li><li>参考：<a href="https://github.com/libvips/libvips/discussions/3856" target="_blank" rel="noopener noreferrer">版本兼容性讨论</a></li></ul></li><li><p><strong>VVC支持问题</strong></p><ul><li>libheif支持VVC相关讨论：<a href="https://github.com/strukturag/libheif/issues/519" target="_blank" rel="noopener noreferrer">VVC支持问题</a></li></ul></li></ol><h4 id="性能优化建议" tabindex="-1"><a class="header-anchor" href="#性能优化建议"><span>性能优化建议</span></a></h4><ol><li><strong>编译优化</strong>：使用<code>-O3</code>优化级别编译</li><li><strong>硬件加速</strong>：考虑使用FPGA加速（参考下方链接）</li><li><strong>内存管理</strong>：合理设置缓冲区大小</li></ol><h3 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h3><h4 id="技术文档" tabindex="-1"><a class="header-anchor" href="#技术文档"><span>技术文档</span></a></h4><ul><li><a href="https://github.com/libvips/libvips/discussions/3173" target="_blank" rel="noopener noreferrer">libvips安装问题</a></li><li><a href="https://github.com/libvips/libvips/discussions/3856" target="_blank" rel="noopener noreferrer">libvips和libheif版本兼容问题</a></li><li><a href="https://github.com/strukturag/libheif/issues/519" target="_blank" rel="noopener noreferrer">libheif支持VVC相关讨论</a></li></ul><h4 id="企业实践案例" tabindex="-1"><a class="header-anchor" href="#企业实践案例"><span>企业实践案例</span></a></h4><ul><li><a href="https://tech.taobao.org/news/fo1d1l" target="_blank" rel="noopener noreferrer">手淘HEIF、AVIF技术演进</a></li><li><a href="https://my.oschina.net/u/4484233/blog/11044121" target="_blank" rel="noopener noreferrer">爱奇艺HEIF、AVIF技术演进</a></li><li><a href="https://developer.volcengine.com/articles/7195758069530230840" target="_blank" rel="noopener noreferrer">字节跳动ImageX的HEIF技术演进</a></li></ul><h4 id="硬件加速" tabindex="-1"><a class="header-anchor" href="#硬件加速"><span>硬件加速</span></a></h4><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzU1NTEzOTM5Mw==&amp;mid=2247495551&amp;idx=1&amp;sn=9fcbb6bd880807ce63f812642a8ee199&amp;utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">FPGA加速技术</a></li><li><a href="https://xupsh.github.io/pp4fpgas-cn/PREFACE.html" target="_blank" rel="noopener noreferrer">FPGA教程</a></li></ul><hr><p><strong>总结：</strong> 本文详细介绍了在CentOS 7环境下安装和配置HEIF编解码器的完整流程，包括基础依赖安装、核心库编译、高级编解码器配置以及应用开发集成。通过遵循本文的安装步骤，您可以成功搭建支持多种图像格式转换的HEIF处理环境。</p>',115)]))}]]),t=JSON.parse('{"path":"/%E5%B7%A5%E5%85%B7%E6%AD%A6%E5%99%A8%E5%BA%93/HEIF%E7%BC%96%E8%A7%A3%E7%A0%81%E5%99%A8%E5%AE%89%E8%A3%85.html","title":"HEIF编解码器安装与配置指南","lang":"zh-CN","frontmatter":{"title":"HEIF编解码器安装与配置指南","date":"2025-06-17T11:39:40.000Z","author":"Navyum","tags":["HEIF","环境安装","图片格式","编解码器"],"categories":["HEIF","图片格式","工具配置"],"article":true,"index":true,"headerDepth":2,"sticky":true,"star":true,"description":"HEIF编解码器安装与配置指南 HEIF（High Efficiency Image Format）是一种高效的图像格式，基于HEVC（H.265）编码标准，相比JPEG格式能够提供更好的压缩率和图像质量。本文详细介绍如何在CentOS 7环境下安装和配置HEIF编解码器，支持多种编码格式的转换。 技术背景 HEIF编码解码原理 ImgImg 支持的编...","head":[["meta",{"property":"og:url","content":"https://myblog.camscanner.top/%E5%B7%A5%E5%85%B7%E6%AD%A6%E5%99%A8%E5%BA%93/HEIF%E7%BC%96%E8%A7%A3%E7%A0%81%E5%99%A8%E5%AE%89%E8%A3%85.html"}],["meta",{"property":"og:site_name","content":"Navyum\'s Blog"}],["meta",{"property":"og:title","content":"HEIF编解码器安装与配置指南"}],["meta",{"property":"og:description","content":"HEIF编解码器安装与配置指南 HEIF（High Efficiency Image Format）是一种高效的图像格式，基于HEVC（H.265）编码标准，相比JPEG格式能够提供更好的压缩率和图像质量。本文详细介绍如何在CentOS 7环境下安装和配置HEIF编解码器，支持多种编码格式的转换。 技术背景 HEIF编码解码原理 ImgImg 支持的编..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.staticdn.net/Navyum/imgbed/main/IMG/21139a95b55bedab5c5a1eaf9a9c4f0b.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-28T12:02:47.000Z"}],["meta",{"property":"article:author","content":"Navyum"}],["meta",{"property":"article:tag","content":"HEIF"}],["meta",{"property":"article:tag","content":"环境安装"}],["meta",{"property":"article:tag","content":"图片格式"}],["meta",{"property":"article:tag","content":"编解码器"}],["meta",{"property":"article:published_time","content":"2025-06-17T11:39:40.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-28T12:02:47.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"HEIF编解码器安装与配置指南\\",\\"image\\":[\\"https://raw.staticdn.net/Navyum/imgbed/main/IMG/21139a95b55bedab5c5a1eaf9a9c4f0b.png\\"],\\"datePublished\\":\\"2025-06-17T11:39:40.000Z\\",\\"dateModified\\":\\"2025-09-28T12:02:47.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Navyum\\"}]}"]]},"git":{"createdTime":1749983452000,"updatedTime":1759060967000,"contributors":[{"name":"Navyum","username":"Navyum","email":"36869790+Navyum@users.noreply.github.com","commits":1,"url":"https://github.com/Navyum"},{"name":"haijun_yang","username":"haijun_yang","email":"haijun_yang@intsig.net","commits":1,"url":"https://github.com/haijun_yang"},{"name":"navyum","username":"navyum","email":"navyum","commits":1,"url":"https://github.com/navyum"}]},"readingTime":{"minutes":7.24,"words":2172},"filePathRelative":"工具武器库/HEIF编解码器安装.md","localizedDate":"2025年6月17日","excerpt":"<h2>HEIF编解码器安装与配置指南</h2>\\n<p>HEIF（High Efficiency Image Format）是一种高效的图像格式，基于HEVC（H.265）编码标准，相比JPEG格式能够提供更好的压缩率和图像质量。本文详细介绍如何在CentOS 7环境下安装和配置HEIF编解码器，支持多种编码格式的转换。</p>\\n<h3>技术背景</h3>\\n<h4>HEIF编码解码原理</h4>\\n<figure><img src=\\"https://raw.staticdn.net/Navyum/imgbed/main/IMG/21139a95b55bedab5c5a1eaf9a9c4f0b.png\\" alt=\\"Img\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>Img</figcaption></figure>","autoDesc":true}')}}]);